<!DOCTYPE html>
<html>
<body>
<script>
var MAX_WORKERS = 8;
var workers = [];

function statusOfWorkers() {
  var str = "";
  for (var i = 0; i < MAX_WORKERS; i++) {
    str += workers[i] ? "1" : "0";
  }
  return str;
}

function startWorker(worker, index) {
  workers[index] = worker;

  worker.onmessage = function(event) {
    worker.terminate();
    workers[index] = null;
    console.log("finished: " + event.data + " workers: " + statusOfWorkers());
    startWorkers();
  };

  worker.postMessage(index);
}

function startWorkers() {
  for (var i = 0; i < MAX_WORKERS; i++) {
    if (!workers[i]) {
      startWorker(new Worker("worker.js"), i);
    }
  }
}

startWorkers();
</script>
</body>
</html>